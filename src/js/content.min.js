function gotoHomepage() {
    if ((new RegExp(".edu.cn")).test(window.location.href.toLowerCase())) {
        window.location.href = "http://www.neea.edu.cn";
        return
    }
    window.location.href = "http://www.neea.cn"
}

function gotoNews() {
    if ((new RegExp(".edu.cn")).test(window.location.href.toLowerCase())) {
        document.getElementById("iframeNews").src = window.location.protocol + "//news.neea.edu.cn/TOPIK/1/newslist.htm";
        return
    }
    document.getElementById("iframeNews").src = window.location.protocol + "//news.neea.cn/TOPIK/1/newslist.htm"
}

function isCapsLockOn(b) {
    var d = b.keyCode || b.which;
    var a = b.shiftKey;
    if (((d >= 65 && d <= 90) && !a) || ((d >= 97 && d <= 122) && a)) {
        return true
    }
    return false
}

function showMsg(b) {
    var a = $("errorMessage");
    a.style.display = "block";
    a.innerHTML = b
}

function hideMsg() {
    $("errorMessage").style.display = "none"
}

function gotoRegister() {
    window.location.href = "RegisterStep1.htm"
}

function showHideTd(a, b, c) {
    if ($("select[@id='" + a + "'] option[@value='" + c + "']").text().length == 0 && c.length > 0) {
        $(b).show();
        $("select[@id='" + a + "'] option[@value='其它']").attr("selected", "selected")
    } else {
        $(b).hide();
        $("select[@id='" + a + "'] option[@value='" + c + "']").attr("selected", "selected")
    }
}

function changeValue(c, b, a) {
    $(b).val(c);
    if ("其它" == c) {
        $(b).val("");
        $(a).show()
    } else {
        $(a).hide()
    }
}

function modifyProfile() {
    $(":button").each(function() {
        $(this).attr("disabled", "disabled")
    });
    window.location.href = "CreateProfile.jhtml"
}

function submitProfile() {
    $(":button").each(function() {
        $(this).attr("disabled", "disabled")
    });
    $("form").submit()
}

function checkCreateProfileInfo() {
    if (isSBCcase("#userPXing") || isSBCcase("#userPMing") || isSBCcase("#userIDNo") || isSBCcase("#userEMAIL")) {
        alert("不要输入全角字符,请把您的输入法换成半角模式。");
        return 0
    }
    if ($("#userXing").val().length > 0 && !isChinese("#userXing")) {
        alert("中文姓请输入中文.");
        $("#userXing").focus();
        return 0
    }
    if ($("#userMing").val().length > 0 && !isChinese("#userMing")) {
        alert("中文名请输入中文.");
        $("#userMing").focus();
        return 0
    }
    if ($("#userPXing").val().length == 0 && $("#userPMing").val().length == 0) {
        alert("拼音姓名不能同时为空.");
        return 0
    }
    if ($("#userPXing").val().length > 0 && !isLetter("#userPXing")) {
        alert("拼音姓请输入字母.");
        $("#userPXing").focus();
        return 0
    }
    if ($("#userPMing").val().length > 0 && !isLetter("#userPMing")) {
        alert("拼音名请输入字母.");
        $("#userPMing").focus();
        return 0
    }
    if ($('input[name="userXb"][@checked]').val() == undefined) {
        alert("请选择性别.");
        return 0
    }
    if (!isDigit("#userYear")) {
        alert("出生年份请输入数字.");
        $("#userYear").focus();
        return 0
    }
    if (!isDigit("#userMonth")) {
        alert("出生月份请输入数字.");
        $("#userMonth").focus();
        return 0
    }
    if (!isDigit("#userDay")) {
        alert("出生日期请输入数字.");
        $("#userDay").focus();
        return 0
    }
    var a = $("#userYear").val() + "-" + $("#userMonth").val() + "-" + $("#userDay").val();
    if (!checkIsValidDate(a)) {
        alert("请输入正确的出生日期.");
        return 0
    }
    if ($('input[name="userIdType"][@checked]').val() == undefined) {
        alert("请选择证件类型.");
        return 0
    }
    if ($("#userIDNo").val().length < 6 || $("#userIDNo").val().length > 18) {
        alert("证件号长度应在6至18位之间.");
        $("#userIDNo").focus();
        return 0
    }
    if (checkXSSInput($("#userIDNo").val())) {
        alert("请输入正确的证件号.");
        $("#userIDNo").focus();
        return 0
    }
    if ($("#userIdType1").is(":checked") == true) {
        alertWarn = isBirthdayOk();
        if (alertWarn.length > 0) {
            alert("身份证的出生日期和实际填写的出生日期不符：" + alertWarn + ",请检查!");
            $("#userIDNo").focus();
            return 0
        }
        alertWarn = isIdCard($("#userIDNo").val(), $("input:radio[name='userXb']:checked").val());
        if (alertWarn.length > 0) {
            alert("身份证检查如下错误:\n  " + alertWarn);
            $("#userIDNo").focus();
            return 0
        }
    }
    if ($("#userIdType7").is(":checked") == true) {
        if ($("#userIDNo").val().substr(0, 6) != "810000" && $("#userIDNo").val().substr(0, 6) != "820000") {
            alert("港澳居民居住证不正确.");
            $("#userIDNo").focus();
            return 0
        }
        alertWarn = isBirthdayOk();
        if (alertWarn.length > 0) {
            alert("港澳居民居住证的出生日期和实际填写的出生日期不符：" + alertWarn + ",请检查!");
            $("#userIDNo").focus();
            return 0
        }
        alertWarn = isIdCard($("#userIDNo").val(), $("input:radio[name='userXb']:checked").val());
        if (alertWarn.length > 0) {
            alert("港澳居民居住证检查如下错误:\n  " + alertWarn);
            $("#userIDNo").focus();
            return 0
        }
    }
    if ($("#userIdType9").is(":checked") == true) {
        if ($("#userIDNo").val().substr(0, 6) != "830000") {
            alert("台湾居民居住证不正确.");
            $("#userIDNo").focus();
            return 0
        }
        alertWarn = isBirthdayOk();
        if (alertWarn.length > 0) {
            alert("台湾居民居住证的出生日期和实际填写的出生日期不符：" + alertWarn + ",请检查!");
            $("#userIDNo").focus();
            return 0
        }
        alertWarn = isIdCard($("#userIDNo").val(), $("input:radio[name='userXb']:checked").val());
        if (alertWarn.length > 0) {
            alert("台湾居民居住证检查如下错误:\n  " + alertWarn);
            $("#userIDNo").focus();
            return 0
        }
    }
    if ($("#userIdType10").is(":checked") == true) {
        if ($("#userIDNo").val().length != 15) {
            alert("外国人永久居留身份证不正确.");
            $("#userIDNo").focus();
            return 0
        }
        puredigit = new RegExp("[a-zA-Z]{3}[0-9]{12}");
        if (!puredigit.test($("#userIDNo").val())) {
            alert("外国人永久居留身份证不正确.");
            $("#userIDNo").focus();
            return 0
        }
    }
    if (isSBCcase("#userPWD") || isSBCcase("#userRePWD")) {
        alert("登录密码中请不要用全角字符.");
        $("#userPWD").focus();
        return 0
    }
    if ($("#userPWD").val() == "") {
        alert("请输入登录密码.");
        $("#userPWD").focus();
        return 0
    }
    if ($("#userRePWD").val() == "") {
        alert("请确认登录密码.");
        $("#userRePWD").focus();
        return 0
    }
    if ($("#userPWD").val().length < 8 || $("#userPWD").val().length > 20) {
        alert("登录密码长度至少8位，最多20位.");
        $("#userPWD").focus();
        return 0
    }
    if ($("#userPWD").val() != $("#userRePWD").val()) {
        alert("登录密码确认与登录密码不符.");
        $("#userPWD").focus();
        return 0
    }
    if (/[ `\\\\]/.test($("#userPWD").val())) {
        alert("登录密码不符合要求.");
        $("#userPWD").focus();
        return 0
    }
    if (checkPasswordLevel($("#userPWD").val())) {
        alert("登录密码不符合要求.");
        $("#userPWD").focus();
        return 0
    }
    if ($("#userAddress").val().length == 0) {
        alert("请输入通讯地址.");
        $("userAddress").focus();
        return 0
    }
    if (checkXSSInput($("#userAddress").val())) {
        alert("请输入正确的通讯地址.");
        $("#userAddress").focus();
        return 0
    }
    if (!isDigit("#userZip")) {
        alert("邮政编码请输入数字.");
        $("#userZip").focus();
        return 0
    }
    if ($("#userZip").val().length != 6) {
        alert("邮政编码请输入6位数字.");
        $("#userZip").focus();
        return 0
    }
    if ($("#userQh").val().length == 0) {
        alert("请输入区号.");
        $("userQh").focus();
        return 0
    }
    if (!isDigit("#userQh")) {
        alert("区号请输入数字.");
        $("#userQh").focus();
        return 0
    }
    if ($("#userTel").val().length == 0) {
        alert("请输入电话号码.");
        $("userTel").focus();
        return 0
    }
    if (!isDigit("#userTel")) {
        alert("电话号码请输入数字.");
        $("#userTel").focus();
        return 0
    }
    if ($("#userMobile").val().length == 0) {
        alert("请输入手机号码.");
        $("userMobile").focus();
        return 0
    }
    if (!isDigit("#userMobile") || $("#userMobile").val().length != 11) {
        alert("手机号码请输入11位数字.");
        $("#userMobile").focus();
        return 0
    }
    if ($("#userMobile").val().substr(0, 1) != "1") {
        alert("手机号码不正确.");
        $("#userMobile").focus();
        return 0
    }
    if ($("#userEMAIL").val().length == 0) {
        alert("请输入电子邮箱地址.");
        $("userEMAIL").focus();
        return 0
    }
    if (!isEmail($("#userEMAIL").val()) || $("#userEMAIL").val().indexOf("*") != -1) {
        alert("请输入正确的电子邮箱地址.");
        $("userEMAIL").focus();
        return 0
    }
    if ($("#userGJ").val().length == 0) {
        alert("请选择国籍.");
        $("selectGJ").focus();
        return 0
    }
    if ($("#userMZ").val().length == 0) {
        alert("请选择民族.");
        $("selectMZ").focus();
        return 0
    }
    if ($("#userMY").val().length == 0) {
        alert("请选择母语.");
        $("selectMY").focus();
        return 0
    }
    if ($("#userZY").val().length == 0) {
        alert("请选择职业.");
        $("selectZY").focus();
        return 0
    }
    if ($("#userKSXXLY").val().length == 0) {
        alert("请选择考试信息来源.");
        $("userKSXXLY").focus();
        return 0
    }
    if ($("#userKSMD").val().length == 0) {
        alert("请选择考试目的.");
        $("userKSMD").focus();
        return 0
    }
    if ($("#userBKLevel option:selected").val() == 0) {
        alert("请选择考试意向级别.");
        $("#userBKLevel").focus();
        return 0
    }
    if ($("#userKDProvince option:selected").val().length == 0 || $("#userKDProvince option:selected").val() == -1) {
        alert("请选择考试意向省份.");
        $("#userKDProvince").focus();
        return 0
    }
    if ($("#userKDCity option:selected").val().length == 0 || $("#userKDCity option:selected").val() == -1 || $("#userKDCity option:selected").val() == "- 请选择城市 -") {
        alert("请选择考试意向城市.");
        $("#userKDCity").focus();
        return 0
    }
    if ($("#userJZProvince option:selected").val().length == 0 || $("#userJZProvince option:selected").val() == -1) {
        alert("请选择现居住省份.");
        $("#userJZProvince").focus();
        return 0
    }
    if ($("#userJZCity option:selected").val().length == 0 || $("#userJZCity option:selected").val() == -1 || $("#userJZCity option:selected").val() == "- 请选择城市 -") {
        alert("请选择现居住城市.");
        $("#userJZCity").focus();
        return 0
    }
    $("#userKDProvinceText").val($("#userKDProvince").find("option:selected").text());
    $("#userJZProvinceText").val($("#userJZProvince").find("option:selected").text());
    return 1
}

function submitRegInfo(a) {
    if (checkCreateProfileInfo() == 0) {
        return
    }
    if (!checkMobileVerifyCode($("#mobileVerifyCode").val())) {
        alert("请填写正确的短信验证码.");
        $("#mobileVerifyCode").focus();
        return
    }
    if ($('input[name="guarantee"][@checked]').val() == undefined) {
        alert("您必须保证信息的真实和准确.");
        $("#guarantee").focus();
        return false
    }
    $(":button").each(function() {
        $(this).attr("disabled", "disabled")
    });
    $("#encryptedPWD").val(CryptoJS.SHA256($("#userPWD").val()));
    a.submit()
}

function checkMobileVerifyCode(b) {
    if (b == "") {
        return false
    } else {
        if (b.length != 6) {
            return false
        } else {
            var a = /^[0-9]+$/;
            return a.test(b)
        }
    }
    return true
}

function isSBCcase(a) {
    puredigit = new RegExp("[０-９Ａ-Ｚａ-ｚ，。？＠　－＿＋－＊＼／［］｛｝；：＂＇︿“～！＃％”]");
    return puredigit.test($(a).val())
}

function isChinese(a) {
    puredigit = new RegExp("[^\u4e00-\u9fa5]");
    return !puredigit.test($(a).val())
}

function isLetter(a) {
    puredigit = new RegExp("[^A-Za-z]");
    return !puredigit.test($(a).val())
}

function isDigit(a) {
    puredigit = new RegExp("[^0-9]");
    return !puredigit.test($(a).val())
}

function isEmail(a) {
    var b = /\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;
    return b.exec(a)
}

function checkIsValidDate(c) {
    if (c == "") {
        return false
    }
    var b = /^((\d{4})|(\d{2}))-(\d{1,2})-(\d{1,2})$/g;
    if ((b.exec(c)) == null) {
        return false
    }
    var d = c.split("-");
    if (parseInt(d[0], 10) < 100) {
        d[0] = 2000 + parseInt(d[0], 10) + ""
    }
    var a = new Date(d[0], (parseInt(d[1], 10) - 1) + "", d[2]);
    if ((a.getFullYear() == parseInt(d[0], 10)) && (a.getMonth() == (parseInt(d[1], 10) - 1)) && (a.getDate() == (parseInt(d[2], 10)))) {
        return true
    } else {
        return false
    }
}

function isIdCard(g, f) {
    var e = "11,12,13,14,15,21,22,23,31,32,33,34,35,36,37,41,42,43,44,45,46,50,51,52,53,54,61,62,63,64,65,71,81,82,83,91,";
    var c = 0;
    var h = "";
    var a = "";
    if (g.length == 15) {
        a = g.substr(0, 6) + "19" + g.substr(6, 9) + "0"
    } else {
        if (g.length == 18) {
            a = g
        } else {
            return "身份证位数不对."
        }
    }
    xb = Number(a.substr(16, 1)) % 2;
    if ((f == "F" && xb == 1) || (f == "M" && xb == 0)) {
        return "身份证和性别不符."
    }
    if (!/^\d{17}(\d|x)$/i.test(a)) {
        return "身份证中有非法字符."
    }
    a = a.replace(/x$/i, "a");
    if (e.indexOf(a.substr(0, 2)) == -1) {
        return "非法地区."
    }
    sBirthday = a.substr(6, 4) + "-" + Number(a.substr(10, 2)) + "-" + Number(a.substr(12, 2));
    var j = new Date(sBirthday.replace(/-/g, "/"));
    if (sBirthday != (j.getFullYear() + "-" + (j.getMonth() + 1) + "-" + j.getDate())) {
        return "身份证错误：非法生日."
    }
    if (g.length == 18) {
        for (var b = 17; b >= 0; b--) {
            c += (Math.pow(2, b) % 11) * parseInt(a.charAt(17 - b), 11)
        }
        if (c % 11 != 1) {
            return "校验错误."
        }
    }
    return ""
}

function isBirthdayOk() {
    if ($("#userIDNo").val().length == 15) {
        s = $("#userIDNo").val().substr(0, 6) + "19" + $("#userIDNo").val().substr(6, 9) + "0"
    } else {
        s = $("#userIDNo").val()
    }
    year = $("#userYear").val();
    months = $("#userMonth").val();
    days = $("#userDay").val();
    if (months.length < 2) {
        months = "0" + months
    }
    if (days.length < 2) {
        days = "0" + days
    }
    if (s.substr(6, 4) != year) {
        return "年份不符"
    } else {
        if (s.substr(10, 2) != months) {
            return "月份不符"
        } else {
            if (s.substr(12, 2) != days) {
                return "日期不符"
            } else {
                return ""
            }
        }
    }
}
Date.prototype.Format = function(a) {
    var c = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        S: this.getMilliseconds()
    };
    if (/(y+)/.test(a)) {
        a = a.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length))
    }
    for (var b in c) {
        if (new RegExp("(" + b + ")").test(a)) {
            a = a.replace(RegExp.$1, (RegExp.$1.length == 1) ? (c[b]) : (("00" + c[b]).substr(("" + c[b]).length)))
        }
    }
    return a
};

function updateProfile() {
    if ($("#userAddress").val().length == 0) {
        alert("请输入通讯地址.");
        $("userAddress").focus();
        return false
    }
    if (checkXSSInput($("#userAddress").val())) {
        alert("请输入正确的通讯地址.");
        $("#userAddress").focus();
        return false
    }
    if (!isDigit("#userZip")) {
        alert("邮政编码请输入数字.");
        $("#userZip").focus();
        return false
    }
    if ($("#userZip").val().length != 6) {
        alert("邮政编码请输入6位数字.");
        $("#userZip").focus();
        return false
    }
    if ($("#userQh").val().length == 0) {
        alert("请输入区号.");
        $("userQh").focus();
        return false
    }
    if (!isDigit("#userQh")) {
        alert("区号请输入数字.");
        $("#userQh").focus();
        return false
    }
    if ($("#userTel").val().length == 0) {
        alert("请输入电话号码.");
        $("userTel").focus();
        return false
    }
    if (!isDigit("#userTel")) {
        alert("电话号码请输入数字.");
        $("#userTel").focus();
        return false
    }
    if ($("#userEMAIL").val().length == 0) {
        alert("请输入电子邮箱地址.");
        $("userEMAIL").focus();
        return false
    }
    if ($("#userEMAIL").val().indexOf("*") != -1) {
        if ($("#userEMAIL").val() != $("#confuseUserEMAIL").val()) {
            alert("请输入正确的电子邮箱地址.");
            $("userEMAIL").focus();
            return false
        }
    } else {
        if (!isEmail($("#userEMAIL").val())) {
            alert("请输入正确的电子邮箱地址.");
            $("userEMAIL").focus();
            return false
        }
    }
    if ($("#userGJ").val().length == 0) {
        alert("请选择国籍.");
        $("selectGJ").focus();
        return false
    }
    if ($("#userMZ").val().length == 0) {
        alert("请选择民族.");
        $("selectMZ").focus();
        return false
    }
    if ($("#userMY").val().length == 0) {
        alert("请选择母语.");
        $("selectMY").focus();
        return false
    }
    if ($("#userZY").val().length == 0) {
        alert("请选择职业.");
        $("selectZY").focus();
        return false
    }
    if ($("#userKSXXLY").val().length == 0) {
        alert("请选择考试信息来源.");
        $("userKSXXLY").focus();
        return false
    }
    if ($("#userKSMD").val().length == 0) {
        alert("请选择考试目的.");
        $("userKSMD").focus();
        return false
    }
    if ($("#checkImage").val().length == 0) {
        alert("请输入验证码.");
        $("checkImage").focus();
        return false
    }
    $(":button").each(function() {
        $(this).attr("disabled", "disabled")
    });
    $("form").submit()
}

function modifyPassword() {
    if (isSBCcase("#userPWD") || isSBCcase("#newPassword") || isSBCcase("#renewPassword")) {
        alert("密码中请不要用全角字符.");
        $("#userPWD").focus();
        return false
    }
    if ($("#userPWD").val() == "") {
        alert("请输入旧密码.");
        $("#userPWD").focus();
        return false
    }
    if ($("#newPassword").val() == "") {
        alert("请输入新密码.");
        $("#newPassword").focus();
        return false
    }
    if ($("#renewPassword").val() == "") {
        alert("请确认新密码.");
        $("#renewPassword").focus();
        return false
    }
    if ($("#newPassword").val().length < 8 || $("#newPassword").val().length > 20) {
        alert("新密码的长度至少8位，最多20位.");
        $("#newPassword").focus();
        return false
    }
    if ($("#newPassword").val() != $("#renewPassword").val()) {
        alert("新密码与新密码确认中输入不一致");
        $("#renewPassword").focus();
        return false
    }
    if (/[ `\\\\]/.test($("#newPassword").val())) {
        alert("新密码不符合要求.");
        $("#newPassword").focus();
        return false
    }
    if (checkPasswordLevel($("#newPassword").val())) {
        alert("新密码不符合要求.");
        $("#newPassword").focus();
        return false
    }
    if ($("#checkImage").val().length < 4) {
        alert("请输入验证码");
        $("#checkImage").focus();
        return false
    }
    $("#encryptedPWD").val(CryptoJS.SHA256($("#userPWD").val()));
    $("#encryptedNewPWD").val(CryptoJS.SHA256($("#newPassword").val()));
    $("form").submit()
}

function pay(b, a) {
    window.location.href = "UFIPayment.jhtml?data=" + b + "&neeaid=" + a
}

function initCaptcha() {
    $("#divCaptcha").hide();
    $("#captchaCode").val("");
    $("#captchaCode").focus(function() {
        if ($("#divCaptcha").is(":hidden")) {
            showCaptcha()
        }
    });
    $("#chkImg").click(function() {
        getCaptcha()
    })
}

function showCaptcha() {
    $("#divCaptcha").show();
    getCaptcha();
    $("#captchaCode").unbind("click")
}

function getCaptcha() {
    $.ajax({
        type: "GET",
        url: "CheckImage.jhtml",
        error: function() {
            alert("获取验证码失败");
            $("#divCaptcha").hide()
        },
        success: function(b) {
            var a = new Image();
            a.src = b;
            a.onload = function() {
                $("#chkImg").attr("src", b)
            };
            a = null;
            $("#divCaptcha").show()
        }
    })
}

function ChooseKd(b, a) {
    $(":button[@name='btnSelect']").each(function() {
        $(this).attr("disabled", "disabled")
    });
    $.ajax({
        type: "POST",
        url: "SelectTestLevel.jhtml",
        data: "kdID=" + b,
        error: function(d, e, c) {
            if (d.status == 500) {
                alert(d.responseText);
                $(":button[@name='btnSelect']").each(function() {
                    $(this).removeAttr("disabled")
                })
            }
        },
        success: function(d) {
            list = d.split(";");
            for (var c = 0; c < list.length; c++) {
                items = list[c].split(":");
                if (items[1] == 1) {
                    if (items[3] == 1) {
                        $("#appLevel" + items[0]).removeAttr("disabled");
                        $("#appSeat" + items[0]).text("有名额")
                    } else {
                        $("#appLevel" + items[0]).attr("disabled", "disabled");
                        $("#appSeat" + items[0]).text("暂无名额")
                    }
                } else {
                    if (items[1] == 2) {
                        $("#appLevel" + items[0]).attr("disabled", "disabled");
                        $("#appLevel" + items[0]).removeAttr("checked");
                        $("#appSeat" + items[0]).text("此级别未开放")
                    } else {
                        $("#appLevel" + items[0]).attr("disabled", "disabled");
                        if (items[2] == 1) {
                            $("#appLevel" + items[0]).attr("checked", "checked")
                        } else {
                            $("#appLevel" + items[0]).removeAttr("checked")
                        }
                        if (items[3] == 1) {
                            $("#appSeat" + items[0]).text("有名额")
                        } else {
                            $("#appSeat" + items[0]).text("暂无名额")
                        }
                    }
                }
            }
            $("#selectKdID").val(b);
            $("#selectKdName").text(a);
            $("#testSites").fadeOut();
            $("#testLevel").fadeIn(200, function() {
                $("#testLevel")[0].scrollIntoView()
            });
            $("#checkimageDiv").show();
            $("#checkimageDiv").append("<b>正在获取验证码...</b>");
            $.ajax({
                type: "GET",
                url: "CheckImage.jhtml",
                error: function() {
                    alert("获取验证码失败");
                    $("#checkimageDiv").hide()
                },
                success: function(e) {
                    if (e.indexOf("<script>") < 0) {
                        $("#checkimageDiv b").remove("");
                        $("#imgdiv").show();
                        $("#checkimg").attr("src", e)
                    }
                }
            });
            $("#testLevel")[0].scrollIntoView()
        }
    })
}

function ReChooseKd() {
    $("#testLevel").fadeOut(200);
    $("#testSites").fadeIn(200, function() {
        $("#testSites")[0].scrollIntoView()
    });
    $(":checkbox").attr("checked", false);
    $(":checkbox").attr("disabled", "disabled");
    for (var a = 1; a < 5; a++) {
        $("#appSeat" + a).text("")
    }
    $(":button[@name='btnSelect']").each(function() {
        $(this).removeAttr("disabled")
    })
}

function selectLevel() {
    if ($("#checkImage").val().length < 4) {
        alert("请输入验证码");
        $("#checkImage").focus();
        return false
    }
    qryStr = buildQueryString();
    if (qryStr == "") {
        return false
    }
    $("#checkImage").val("");
    $.ajax({
        type: "POST",
        url: "CreateAppointment.jhtml",
        data: qryStr,
        error: function(b, c, a) {
            if (b.status == 500) {
                alert(b.responseText);
                $(":button #btnSelect").each(function() {
                    $(this).removeAttr("disabled")
                });
                ReChooseKd()
            }
        },
        success: function(a) {
            alert(a);
            window.location.reload()
        }
    })
}

function buildQueryString() {
    levelAm = 0;
    if ($("#appLevel1").attr("checked") == true && $("#appLevel1").attr("disabled") == false) {
        levelAm = $("#appLevel1").attr("value")
    } else {
        if ($("#appLevel3").attr("checked") == true && $("#appLevel3").attr("disabled") == false) {
            levelAm = $("#appLevel3").attr("value")
        }
    }
    levelPm = 0;
    if ($("#appLevel2").attr("checked") == true && $("#appLevel2").attr("disabled") == false) {
        levelPm = $("#appLevel2").attr("value")
    } else {
        if ($("#appLevel4").attr("checked") == true && $("#appLevel4").attr("disabled") == false) {
            levelPm = $("#appLevel4").attr("value")
        }
    }
    if (levelAm == 0 && levelPm == 0) {
        alert("请选择报考级别");
        return ""
    }
    qryStr = "kdID=" + $("#selectKdID").val() + "&levels=" + levelAm + "," + levelPm + "&checkImage=" + $("#checkImage").val();
    return qryStr
}

function ChooseOtherLevel() {
    ReChooseKd()
}

function CancelKd(b, a) {
    if (!confirm("您确定要取消预定吗？取消后将不能恢复，如果您取消预定次数过多，系统将锁定您的帐号。解锁帐号，请与教育部教育考试院韩国语能力考试报名网站咨询电话联系。")) {
        return false
    }
    $("#btnCancelKD" + b).attr("disabled", "disabled");
    $.ajax({
        type: "POST",
        url: "CancelAppointment.jhtml",
        data: "data=" + b + "&neeaid=" + a,
        error: function(d, e, c) {
            if (d.status == 500) {
                alert(d.responseText)
            }
            window.location.reload()
        },
        success: function(c, d) {
            alert(c);
            window.location.reload()
        }
    })
}

function ShowChangeKd(b, a) {
    $("#changeTestSite").show("fast", function() {
        $("#changeTestSite")[0].scrollIntoView()
    });
    $("#changeTestSite").load("ChangeTestSite.jhtml?method=show", {
        data: b,
        neeaid: a
    }, function() {
        $("#changeTestSite")[0].scrollIntoView()
    })
}

function ChangeKd(c, a, d, b) {
    if (!confirm("您已经成功报考，并且有且仅有一次免费更改考点的机会，您确定要更改到 " + a + " 吗？")) {
        return false
    }
    $(":button[@name='btnChange']").attr("disabled", "disabled");
    $.ajax({
        type: "POST",
        url: "ChangeTestSite.jhtml?method=update",
        data: "kdid=" + c + "&data=" + d + "&neeaid=" + b,
        error: function(f, g, e) {
            if (f.status == 500) {
                alert(f.responseText)
            }
            window.location.reload()
        },
        success: function(e, f) {
            alert(e);
            window.location.reload()
        }
    })
}

function checkPasswordLevel(a) {
    var b = 0;
    if (/\d/.test(a)) {
        b++
    }
    if (/[a-z]/.test(a)) {
        b++
    }
    if (/[A-Z]/.test(a)) {
        b++
    }
    if (/[`~!@#\$%\^&\*\(\)_\+-]/.test(a)) {
        b++
    }
    return b < 3
}

function checkXSSInput(b) {
    var a = b.toLowerCase();
    if (a.indexOf("<script>") != -1 || a.indexOf("<\/script>") != -1 || a.indexOf("alert") != -1 || a.indexOf("onclick") != -1 || a.indexOf("prompt") != -1) {
        return true
    }
}
var timeout;

function setCountdown(a, d, c, b) {
    clearTimeout(timeout);
    if (b == 0) {
        a.removeAttribute("disabled");
        a.value = d;
        return
    } else {
        a.setAttribute("disabled", "disabled");
        a.value = b + c;
        b--
    }
    timeout = setTimeout(function() {
        setCountdown(a, d, c, b)
    }, 1000)
}

function ShowOnlineService(c, b, a) {
    $("#maincontentDiv").load("OnlineService.jhtml?method=show", {
        type: c,
        neeaid: b,
        taskCategoryIdChoose: a
    }, function() {})
}

function CreateOnlineService(b, a) {
    if ($("#taskCategoryType").val() == "") {
        alert("请选择申请原因");
        $("#taskCategoryType").focus();
        return false
    }
    $("#btnCreate").attr("disabled", true);
    $.ajax({
        type: "POST",
        url: "OnlineService.jhtml?method=create",
        data: "taskCategoryType=" + $("#taskCategoryType").val() + "&type=" + b + "&neeaid=" + a,
        error: function(d, e, c) {
            if (d.status == 500) {
                alert(d.responseText);
                $("#btnCreate").attr("disabled", false)
            }
        },
        success: function(c, d) {
            $("#maincontentDiv").load("UploadOnlineService.jhtml?method=show", {
                type: b,
                neeaid: a,
                taskDetailId: c
            }, function() {})
        }
    })
}

function DeleteOnlineService(c, b, a) {
    if (window.confirm("您确认撤销退考申请吗？撤销后，您可在截止时间前重新申请。")) {
        $("#btnDelete").attr("disabled", true);
        $.ajax({
            type: "POST",
            url: "OnlineService.jhtml?method=delete",
            data: "taskDetailId=" + a + "&type=" + c + "&neeaid=" + b,
            error: function(e, f, d) {
                if (e.status == 500) {
                    alert(e.responseText);
                    $("#btnDelete").attr("disabled", false)
                }
            },
            success: function(d, e) {
                alert(d);
                window.location.reload()
            }
        })
    }
}

function ShowFileUpload(c, b, a) {
    $("#maincontentDiv").load("UploadOnlineService.jhtml?method=show", {
        type: c,
        neeaid: b,
        taskDetailId: a
    }, function() {})
};